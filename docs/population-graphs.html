<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Population Genetics</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A textbook for the use of R in spatial genetic data analysis.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Population Genetics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="media/TitlePage_small.png" />
  <meta property="og:description" content="A textbook for the use of R in spatial genetic data analysis." />
  <meta name="github-repo" content="dyerlab/AMG" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Population Genetics" />
  
  <meta name="twitter:description" content="A textbook for the use of R in spatial genetic data analysis." />
  <meta name="twitter:image" content="media/TitlePage_small.png" />

<meta name="author" content="Rodney J. Dyer">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="distance-networks.html">
<link rel="next" href="interactive-visualization.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>
<script src="libs/leaflet-providers-1.0.27/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-1.1.0/leaflet-providers-plugin.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.3/sankeyNetwork.js"></script>
<script src="libs/dendroNetwork-binding-0.3/dendroNetwork.js"></script>
<script src="libs/simpleNetwork-binding-0.3/simpleNetwork.js"></script>
<script src="libs/forceNetwork-binding-0.3/forceNetwork.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="media/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Applied Population Genetics</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#logistics"><i class="fa fa-check"></i>Logistics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#typography"><i class="fa fa-check"></i>Typography</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#interactive-content"><i class="fa fa-check"></i>Interactive Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dedication"><i class="fa fa-check"></i>Dedication</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html"><i class="fa fa-check"></i><b>1</b> The R Ecosystem</a><ul>
<li class="chapter" data-level="1.1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#getting-r-configured"><i class="fa fa-check"></i><b>1.1</b> Getting R Configured</a><ul>
<li class="chapter" data-level="1.1.1" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#packages"><i class="fa fa-check"></i><b>1.1.1</b> Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#cran"><i class="fa fa-check"></i><b>1.1.2</b> CRAN</a></li>
<li class="chapter" data-level="1.1.3" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#github"><i class="fa fa-check"></i><b>1.1.3</b> GitHub</a></li>
<li class="chapter" data-level="1.1.4" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#bioconductor"><i class="fa fa-check"></i><b>1.1.4</b> Bioconductor</a></li>
<li class="chapter" data-level="1.1.5" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#troublesome-packages"><i class="fa fa-check"></i><b>1.1.5</b> Troublesome Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#libraries-used-in-text"><i class="fa fa-check"></i><b>1.2</b> Libraries Used in Text</a></li>
<li class="chapter" data-level="1.3" data-path="the-r-ecosystem.html"><a href="the-r-ecosystem.html#the-rstudio-environment"><i class="fa fa-check"></i><b>1.3</b> The RStudio Environment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>2</b> Data Types</a><ul>
<li class="chapter" data-level="2.1" data-path="data-types.html"><a href="data-types.html#numeric-data-types"><i class="fa fa-check"></i><b>2.1</b> Numeric Data Types</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-types.html"><a href="data-types.html#coercion-to-numeric"><i class="fa fa-check"></i><b>2.1.1</b> Coercion to Numeric</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-types.html"><a href="data-types.html#characters"><i class="fa fa-check"></i><b>2.2</b> Characters</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-types.html"><a href="data-types.html#concatenation-of-characters"><i class="fa fa-check"></i><b>2.2.1</b> Concatenation of Characters</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-types.html"><a href="data-types.html#coercion-to-characters"><i class="fa fa-check"></i><b>2.2.2</b> Coercion to Characters</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-types.html"><a href="data-types.html#factors"><i class="fa fa-check"></i><b>2.3</b> Factors</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-types.html"><a href="data-types.html#missing-levels-in-factors"><i class="fa fa-check"></i><b>2.3.1</b> Missing Levels in Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-types.html"><a href="data-types.html#logical-types"><i class="fa fa-check"></i><b>2.4</b> Logical Types</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-containers.html"><a href="data-containers.html"><i class="fa fa-check"></i><b>3</b> Data Containers</a><ul>
<li class="chapter" data-level="3.1" data-path="data-containers.html"><a href="data-containers.html#vectors"><i class="fa fa-check"></i><b>3.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="data-containers.html"><a href="data-containers.html#matrices"><i class="fa fa-check"></i><b>3.2</b> Matrices</a></li>
<li class="chapter" data-level="3.3" data-path="data-containers.html"><a href="data-containers.html#lists"><i class="fa fa-check"></i><b>3.3</b> Lists</a></li>
<li class="chapter" data-level="3.4" data-path="data-containers.html"><a href="data-containers.html#data-frames"><i class="fa fa-check"></i><b>3.4</b> Data Frames</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-containers.html"><a href="data-containers.html#indexing-data-frames"><i class="fa fa-check"></i><b>3.4.1</b> Indexing Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>4</b> Programming</a><ul>
<li class="chapter" data-level="4.1" data-path="programming.html"><a href="programming.html#function-writing"><i class="fa fa-check"></i><b>4.1</b> Function Writing</a></li>
<li class="chapter" data-level="4.2" data-path="programming.html"><a href="programming.html#variable-scope"><i class="fa fa-check"></i><b>4.2</b> Variable Scope</a></li>
<li class="chapter" data-level="4.3" data-path="programming.html"><a href="programming.html#decision-making"><i class="fa fa-check"></i><b>4.3</b> Decision Making</a><ul>
<li class="chapter" data-level="4.3.1" data-path="programming.html"><a href="programming.html#the-if-pattern"><i class="fa fa-check"></i><b>4.3.1</b> The if Pattern</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="programming.html"><a href="programming.html#the-if-else-pattern"><i class="fa fa-check"></i><b>4.4</b> The <code>if-else</code> Pattern</a></li>
<li class="chapter" data-level="4.5" data-path="programming.html"><a href="programming.html#flow-control"><i class="fa fa-check"></i><b>4.5</b> Flow Control</a><ul>
<li class="chapter" data-level="4.5.1" data-path="programming.html"><a href="programming.html#the-for-loop"><i class="fa fa-check"></i><b>4.5.1</b> The for() Loop</a></li>
<li class="chapter" data-level="4.5.2" data-path="programming.html"><a href="programming.html#short-circuiting-the-loop"><i class="fa fa-check"></i><b>4.5.2</b> Short Circuiting the Loop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#univariate-data"><i class="fa fa-check"></i><b>5.1</b> Univariate Data</a></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#plotting-parameters"><i class="fa fa-check"></i><b>5.2</b> Plotting Parameters</a></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#density-plots"><i class="fa fa-check"></i><b>5.3</b> Density Plots</a></li>
<li class="chapter" data-level="5.4" data-path="graphics.html"><a href="graphics.html#overlaying-plots"><i class="fa fa-check"></i><b>5.4</b> Overlaying Plots</a></li>
<li class="chapter" data-level="5.5" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>5.5</b> Boxplots</a></li>
<li class="chapter" data-level="5.6" data-path="graphics.html"><a href="graphics.html#scatter-plots"><i class="fa fa-check"></i><b>5.6</b> Scatter Plots</a></li>
<li class="chapter" data-level="5.7" data-path="graphics.html"><a href="graphics.html#multiple-plots"><i class="fa fa-check"></i><b>5.7</b> Multiple Plots</a></li>
<li class="chapter" data-level="5.8" data-path="graphics.html"><a href="graphics.html#color-palettes"><i class="fa fa-check"></i><b>5.8</b> Color Palettes</a></li>
<li class="chapter" data-level="5.9" data-path="graphics.html"><a href="graphics.html#rcolorbrewer"><i class="fa fa-check"></i><b>5.9</b> RColorBrewer</a></li>
<li class="chapter" data-level="5.10" data-path="graphics.html"><a href="graphics.html#saving-imagery"><i class="fa fa-check"></i><b>5.10</b> Saving Imagery</a></li>
<li class="chapter" data-level="5.11" data-path="graphics.html"><a href="graphics.html#interactive-graphics"><i class="fa fa-check"></i><b>5.11</b> Interactive Graphics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproducable-research.html"><a href="reproducable-research.html"><i class="fa fa-check"></i><b>6</b> Reproducable Research</a><ul>
<li class="chapter" data-level="6.1" data-path="reproducable-research.html"><a href="reproducable-research.html#keeping-data-on-google-drive"><i class="fa fa-check"></i><b>6.1</b> Keeping Data on Google Drive</a></li>
<li class="chapter" data-level="6.2" data-path="reproducable-research.html"><a href="reproducable-research.html#integrating-into-slack"><i class="fa fa-check"></i><b>6.2</b> Integrating into Slack</a><ul>
<li class="chapter" data-level="6.2.1" data-path="reproducable-research.html"><a href="reproducable-research.html#fixing-problem-with-version-1.4.1"><i class="fa fa-check"></i><b>6.2.1</b> Fixing Problem with Version 1.4.1</a></li>
<li class="chapter" data-level="6.2.2" data-path="reproducable-research.html"><a href="reproducable-research.html#configuration"><i class="fa fa-check"></i><b>6.2.2</b> Configuration</a></li>
<li class="chapter" data-level="6.2.3" data-path="reproducable-research.html"><a href="reproducable-research.html#sending-text-and-graphical-ouput"><i class="fa fa-check"></i><b>6.2.3</b> Sending Text and Graphical Ouput</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Single Population</b></span></li>
<li class="chapter" data-level="7" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html"><i class="fa fa-check"></i><b>7</b> Hardy-Weinberg Equilibrium</a><ul>
<li class="chapter" data-level="7.1" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#genetic-assumptions"><i class="fa fa-check"></i><b>7.1</b> Genetic Assumptions</a><ul>
<li class="chapter" data-level="7.1.1" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#punnet-squares"><i class="fa fa-check"></i><b>7.1.1</b> Punnet Squares</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#evolutionary-assumptions"><i class="fa fa-check"></i><b>7.2</b> Evolutionary Assumptions</a></li>
<li class="chapter" data-level="7.3" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#the-mechanics"><i class="fa fa-check"></i><b>7.3</b> The Mechanics</a></li>
<li class="chapter" data-level="7.4" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#trans-generational-transition-probabilities"><i class="fa fa-check"></i><b>7.4</b> Trans-Generational Transition Probabilities</a></li>
<li class="chapter" data-level="7.5" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#consequences-of-hwe"><i class="fa fa-check"></i><b>7.5</b> Consequences of HWE</a></li>
<li class="chapter" data-level="7.6" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#zygotic-gene-flow"><i class="fa fa-check"></i><b>7.6</b> Zygotic Gene Flow</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="genetic-drift.html"><a href="genetic-drift.html"><i class="fa fa-check"></i><b>8</b> Genetic Drift</a><ul>
<li class="chapter" data-level="8.1" data-path="genetic-drift.html"><a href="genetic-drift.html#consequences-of-genetic-drift"><i class="fa fa-check"></i><b>8.1</b> Consequences of Genetic Drift</a><ul>
<li class="chapter" data-level="8.1.1" data-path="genetic-drift.html"><a href="genetic-drift.html#time-to-fixation"><i class="fa fa-check"></i><b>8.1.1</b> Time to Fixation</a></li>
<li class="chapter" data-level="8.1.2" data-path="genetic-drift.html"><a href="genetic-drift.html#time-to-allele-loss"><i class="fa fa-check"></i><b>8.1.2</b> Time to Allele Loss</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="genetic-drift.html"><a href="genetic-drift.html#mutation-drift"><i class="fa fa-check"></i><b>8.2</b> Mutation &amp; Drift</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="effective-population-size.html"><a href="effective-population-size.html"><i class="fa fa-check"></i><b>9</b> Effective Population Size</a><ul>
<li class="chapter" data-level="9.1" data-path="effective-population-size.html"><a href="effective-population-size.html#demographic-effective-population-sizes"><i class="fa fa-check"></i><b>9.1</b> Demographic Effective Population Sizes</a></li>
<li class="chapter" data-level="9.2" data-path="effective-population-size.html"><a href="effective-population-size.html#genetic-effective-population-size"><i class="fa fa-check"></i><b>9.2</b> Genetic Effective Population Size</a><ul>
<li class="chapter" data-level="9.2.1" data-path="effective-population-size.html"><a href="effective-population-size.html#inbreeding-effective-population-size"><i class="fa fa-check"></i><b>9.2.1</b> Inbreeding Effective Population Size</a></li>
<li class="chapter" data-level="9.2.2" data-path="effective-population-size.html"><a href="effective-population-size.html#variance-effective-population-size"><i class="fa fa-check"></i><b>9.2.2</b> Variance Effective Population Size</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="effective-population-size.html"><a href="effective-population-size.html#fluctuating-population-size"><i class="fa fa-check"></i><b>9.3</b> Fluctuating Population Size</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mutation.html"><a href="mutation.html"><i class="fa fa-check"></i><b>10</b> Mutation</a><ul>
<li class="chapter" data-level="10.1" data-path="mutation.html"><a href="mutation.html#mutation-models"><i class="fa fa-check"></i><b>10.1</b> Mutation Models</a><ul>
<li class="chapter" data-level="10.1.1" data-path="mutation.html"><a href="mutation.html#fixed-allele-model"><i class="fa fa-check"></i><b>10.1.1</b> Fixed Allele Model</a></li>
<li class="chapter" data-level="10.1.2" data-path="mutation.html"><a href="mutation.html#infinite-allele-model"><i class="fa fa-check"></i><b>10.1.2</b> Infinite Allele Model</a></li>
<li class="chapter" data-level="10.1.3" data-path="mutation.html"><a href="mutation.html#stepwise-mutation-model"><i class="fa fa-check"></i><b>10.1.3</b> Stepwise Mutation Model</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="mutation.html"><a href="mutation.html#mutation-and-inbreeding"><i class="fa fa-check"></i><b>10.2</b> Mutation and Inbreeding</a></li>
<li class="chapter" data-level="10.3" data-path="mutation.html"><a href="mutation.html#estimating-mutation"><i class="fa fa-check"></i><b>10.3</b> Estimating Mutation</a><ul>
<li class="chapter" data-level="10.3.1" data-path="mutation.html"><a href="mutation.html#phenotypes"><i class="fa fa-check"></i><b>10.3.1</b> Phenotypes</a></li>
<li class="chapter" data-level="10.3.2" data-path="mutation.html"><a href="mutation.html#genotypes"><i class="fa fa-check"></i><b>10.3.2</b> Genotypes</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Nonrandom Rating</b></span></li>
<li class="chapter" data-level="11" data-path="selfing.html"><a href="selfing.html"><i class="fa fa-check"></i><b>11</b> Selfing</a><ul>
<li class="chapter" data-level="11.1" data-path="selfing.html"><a href="selfing.html#changes-in-f"><i class="fa fa-check"></i><b>11.1</b> Changes in F</a><ul>
<li class="chapter" data-level="11.1.1" data-path="selfing.html"><a href="selfing.html#theoretical-expectations"><i class="fa fa-check"></i><b>11.1.1</b> Theoretical Expectations</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="selfing.html"><a href="selfing.html#simulation-example"><i class="fa fa-check"></i><b>11.2</b> Simulation Example</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mixed-mating-systems.html"><a href="mixed-mating-systems.html"><i class="fa fa-check"></i><b>12</b> Mixed Mating Systems</a><ul>
<li class="chapter" data-level="12.1" data-path="mixed-mating-systems.html"><a href="mixed-mating-systems.html#mixed-mating-genotype-frequency-equilibriums"><i class="fa fa-check"></i><b>12.1</b> Mixed Mating Genotype Frequency Equilibriums</a></li>
<li class="chapter" data-level="12.2" data-path="mixed-mating-systems.html"><a href="mixed-mating-systems.html#estimating-selfing-rates"><i class="fa fa-check"></i><b>12.2</b> Estimating Selfing Rates</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="wahlund-effects.html"><a href="wahlund-effects.html"><i class="fa fa-check"></i><b>13</b> Wahlund Effects</a></li>
<li class="part"><span><b>III Parent Offspring Data</b></span></li>
<li class="chapter" data-level="14" data-path="pedigrees.html"><a href="pedigrees.html"><i class="fa fa-check"></i><b>14</b> Pedigrees</a><ul>
<li class="chapter" data-level="14.1" data-path="pedigrees.html"><a href="pedigrees.html#expectations-for-f-in-a-pedigree."><i class="fa fa-check"></i><b>14.1</b> Expectations for F in a pedigree.</a></li>
<li class="chapter" data-level="14.2" data-path="pedigrees.html"><a href="pedigrees.html#drawing-pedigrees"><i class="fa fa-check"></i><b>14.2</b> Drawing Pedigrees</a></li>
<li class="chapter" data-level="14.3" data-path="pedigrees.html"><a href="pedigrees.html#skills"><i class="fa fa-check"></i><b>14.3</b> Skills</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="parentage-analyses.html"><a href="parentage-analyses.html"><i class="fa fa-check"></i><b>15</b> Parentage Analyses</a><ul>
<li class="chapter" data-level="15.1" data-path="parentage-analyses.html"><a href="parentage-analyses.html#paternity-vs.maternity"><i class="fa fa-check"></i><b>15.1</b> Paternity vs. Maternity</a></li>
<li class="chapter" data-level="15.2" data-path="parentage-analyses.html"><a href="parentage-analyses.html#probability-of-exclusion"><i class="fa fa-check"></i><b>15.2</b> Probability of Exclusion</a></li>
<li class="chapter" data-level="15.3" data-path="parentage-analyses.html"><a href="parentage-analyses.html#paternity-exclusion"><i class="fa fa-check"></i><b>15.3</b> Paternity Exclusion</a></li>
<li class="chapter" data-level="15.4" data-path="parentage-analyses.html"><a href="parentage-analyses.html#fractional-paternity"><i class="fa fa-check"></i><b>15.4</b> Fractional Paternity</a></li>
<li class="chapter" data-level="15.5" data-path="parentage-analyses.html"><a href="parentage-analyses.html#dispersal-kernels"><i class="fa fa-check"></i><b>15.5</b> Dispersal Kernels</a></li>
</ul></li>
<li class="part"><span><b>IV Subdivided Populations</b></span></li>
<li class="chapter" data-level="16" data-path="mapping-populations.html"><a href="mapping-populations.html"><i class="fa fa-check"></i><b>16</b> Mapping Populations</a><ul>
<li class="chapter" data-level="16.1" data-path="mapping-populations.html"><a href="mapping-populations.html#procedure"><i class="fa fa-check"></i><b>16.1</b> Procedure</a></li>
<li class="chapter" data-level="16.2" data-path="mapping-populations.html"><a href="mapping-populations.html#plotting-population-locations"><i class="fa fa-check"></i><b>16.2</b> Plotting Population Locations</a></li>
<li class="chapter" data-level="16.3" data-path="mapping-populations.html"><a href="mapping-populations.html#population-allele-frequencies"><i class="fa fa-check"></i><b>16.3</b> Population Allele Frequencies</a></li>
<li class="chapter" data-level="16.4" data-path="mapping-populations.html"><a href="mapping-populations.html#dynamic-maps"><i class="fa fa-check"></i><b>16.4</b> Dynamic maps</a><ul>
<li class="chapter" data-level="16.4.1" data-path="mapping-populations.html"><a href="mapping-populations.html#sankey-networks"><i class="fa fa-check"></i><b>16.4.1</b> Sankey Networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="population-models.html"><a href="population-models.html"><i class="fa fa-check"></i><b>17</b> Population Models</a><ul>
<li class="chapter" data-level="17.1" data-path="population-models.html"><a href="population-models.html#models-of-partition"><i class="fa fa-check"></i><b>17.1</b> Models of Partition</a></li>
<li class="chapter" data-level="17.2" data-path="population-models.html"><a href="population-models.html#island-mainland-model"><i class="fa fa-check"></i><b>17.2</b> Island Mainland Model</a></li>
<li class="chapter" data-level="17.3" data-path="population-models.html"><a href="population-models.html#the-island-model"><i class="fa fa-check"></i><b>17.3</b> The Island Model</a></li>
<li class="chapter" data-level="17.4" data-path="population-models.html"><a href="population-models.html#stepping-stone-models"><i class="fa fa-check"></i><b>17.4</b> Stepping Stone Models</a></li>
<li class="chapter" data-level="17.5" data-path="population-models.html"><a href="population-models.html#the-general-model"><i class="fa fa-check"></i><b>17.5</b> The General Model</a></li>
<li class="chapter" data-level="17.6" data-path="population-models.html"><a href="population-models.html#general-strategies"><i class="fa fa-check"></i><b>17.6</b> General Strategies</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="genetic-diversity.html"><a href="genetic-diversity.html"><i class="fa fa-check"></i><b>18</b> Genetic Diversity</a><ul>
<li class="chapter" data-level="18.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#allelic-diversity"><i class="fa fa-check"></i><b>18.1</b> Allelic Diversity</a></li>
<li class="chapter" data-level="18.2" data-path="genetic-diversity.html"><a href="genetic-diversity.html#genotypic-diversity"><i class="fa fa-check"></i><b>18.2</b> Genotypic Diversity</a></li>
<li class="chapter" data-level="18.3" data-path="genetic-diversity.html"><a href="genetic-diversity.html#samples-from-several-locales"><i class="fa fa-check"></i><b>18.3</b> Samples from Several Locales</a></li>
<li class="chapter" data-level="18.4" data-path="genetic-diversity.html"><a href="genetic-diversity.html#multilocus-diversity"><i class="fa fa-check"></i><b>18.4</b> Multilocus Diversity</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="rarefaction.html"><a href="rarefaction.html"><i class="fa fa-check"></i><b>19</b> Rarefaction</a><ul>
<li class="chapter" data-level="19.1" data-path="rarefaction.html"><a href="rarefaction.html#mapping-diversity"><i class="fa fa-check"></i><b>19.1</b> Mapping Diversity</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="genetic-distances.html"><a href="genetic-distances.html"><i class="fa fa-check"></i><b>20</b> Genetic Distances</a><ul>
<li class="chapter" data-level="20.1" data-path="genetic-distances.html"><a href="genetic-distances.html#individual-genetic-distance"><i class="fa fa-check"></i><b>20.1</b> Individual Genetic Distance</a><ul>
<li class="chapter" data-level="20.1.1" data-path="genetic-distances.html"><a href="genetic-distances.html#euclidean-distance"><i class="fa fa-check"></i><b>20.1.1</b> Euclidean Distance</a></li>
<li class="chapter" data-level="20.1.2" data-path="genetic-distances.html"><a href="genetic-distances.html#amova-distance"><i class="fa fa-check"></i><b>20.1.2</b> AMOVA Distance</a></li>
<li class="chapter" data-level="20.1.3" data-path="genetic-distances.html"><a href="genetic-distances.html#bray-curtis-individual-distance"><i class="fa fa-check"></i><b>20.1.3</b> Bray-Curtis Individual Distance</a></li>
<li class="chapter" data-level="20.1.4" data-path="genetic-distances.html"><a href="genetic-distances.html#ladder-distance"><i class="fa fa-check"></i><b>20.1.4</b> Ladder Distance</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="genetic-distances.html"><a href="genetic-distances.html#population-level-genetic-distances"><i class="fa fa-check"></i><b>20.2</b> Population-Level Genetic Distances</a><ul>
<li class="chapter" data-level="20.2.1" data-path="genetic-distances.html"><a href="genetic-distances.html#czekanowski-manhattan-distance"><i class="fa fa-check"></i><b>20.2.1</b> Czekanowski (Manhattan) Distance</a></li>
<li class="chapter" data-level="20.2.2" data-path="genetic-distances.html"><a href="genetic-distances.html#rogers-euclidean-distance"><i class="fa fa-check"></i><b>20.2.2</b> Rogers (Euclidean) Distance</a></li>
<li class="chapter" data-level="20.2.3" data-path="genetic-distances.html"><a href="genetic-distances.html#neis-genetic-distance"><i class="fa fa-check"></i><b>20.2.3</b> Nei’s Genetic Distance</a></li>
<li class="chapter" data-level="20.2.4" data-path="genetic-distances.html"><a href="genetic-distances.html#conditional-genetic-distance"><i class="fa fa-check"></i><b>20.2.4</b> Conditional Genetic Distance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="genetic-structure.html"><a href="genetic-structure.html"><i class="fa fa-check"></i><b>21</b> Genetic Structure</a><ul>
<li class="chapter" data-level="21.1" data-path="genetic-structure.html"><a href="genetic-structure.html#f-statistics-and-thier-ilk"><i class="fa fa-check"></i><b>21.1</b> F-Statistics and Thier Ilk</a><ul>
<li class="chapter" data-level="21.1.1" data-path="genetic-structure.html"><a href="genetic-structure.html#issues-with-fixation-indices"><i class="fa fa-check"></i><b>21.1.1</b> Issues with Fixation Indices</a></li>
<li class="chapter" data-level="21.1.2" data-path="genetic-structure.html"><a href="genetic-structure.html#additional-x_st-like-parameters"><i class="fa fa-check"></i><b>21.1.2</b> Additional <span class="math inline">\(X_{ST}\)</span>-like Parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="genetic-structure.html"><a href="genetic-structure.html#statistical-structure"><i class="fa fa-check"></i><b>21.2</b> Statistical Structure</a></li>
<li class="chapter" data-level="21.3" data-path="genetic-structure.html"><a href="genetic-structure.html#final-thoughts-on-structure"><i class="fa fa-check"></i><b>21.3</b> Final Thoughts on Structure</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="population-assignment.html"><a href="population-assignment.html"><i class="fa fa-check"></i><b>22</b> Population Assignment</a></li>
<li class="chapter" data-level="23" data-path="admixture.html"><a href="admixture.html"><i class="fa fa-check"></i><b>23</b> Admixture</a></li>
<li class="part"><span><b>V Statistical Models</b></span></li>
<li class="chapter" data-level="24" data-path="ordination-of-genetic-data.html"><a href="ordination-of-genetic-data.html"><i class="fa fa-check"></i><b>24</b> Ordination of Genetic Data</a><ul>
<li class="chapter" data-level="24.1" data-path="ordination-of-genetic-data.html"><a href="ordination-of-genetic-data.html#hierarchical-clustering"><i class="fa fa-check"></i><b>24.1</b> Hierarchical Clustering</a></li>
<li class="chapter" data-level="24.2" data-path="ordination-of-genetic-data.html"><a href="ordination-of-genetic-data.html#interactive-tree-display"><i class="fa fa-check"></i><b>24.2</b> Interactive Tree Display</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="distance-matrices.html"><a href="distance-matrices.html"><i class="fa fa-check"></i><b>25</b> Distance Matrices</a><ul>
<li class="chapter" data-level="25.1" data-path="distance-matrices.html"><a href="distance-matrices.html#visual-comparisons"><i class="fa fa-check"></i><b>25.1</b> Visual Comparisons</a></li>
<li class="chapter" data-level="25.2" data-path="distance-matrices.html"><a href="distance-matrices.html#the-mantel-test"><i class="fa fa-check"></i><b>25.2</b> The Mantel Test</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>26</b> Linear Models</a><ul>
<li class="chapter" data-level="26.1" data-path="linear-models.html"><a href="linear-models.html#dependent-independent-relationships"><i class="fa fa-check"></i><b>26.1</b> Dependent &amp; Independent Relationships</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="distance-networks.html"><a href="distance-networks.html"><i class="fa fa-check"></i><b>27</b> Distance Networks</a><ul>
<li class="chapter" data-level="27.1" data-path="distance-networks.html"><a href="distance-networks.html#graph-structure"><i class="fa fa-check"></i><b>27.1</b> Graph Structure</a><ul>
<li class="chapter" data-level="27.1.1" data-path="distance-networks.html"><a href="distance-networks.html#node-edge-attributes"><i class="fa fa-check"></i><b>27.1.1</b> Node &amp; Edge Attributes</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="distance-networks.html"><a href="distance-networks.html#plotting-a-graphs"><i class="fa fa-check"></i><b>27.2</b> Plotting a Graphs</a></li>
<li class="chapter" data-level="27.3" data-path="distance-networks.html"><a href="distance-networks.html#mapping-networks"><i class="fa fa-check"></i><b>27.3</b> Mapping Networks</a></li>
<li class="chapter" data-level="27.4" data-path="distance-networks.html"><a href="distance-networks.html#genetic-distance-graphs"><i class="fa fa-check"></i><b>27.4</b> Genetic Distance Graphs</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="population-graphs.html"><a href="population-graphs.html"><i class="fa fa-check"></i><b>28</b> Population Graphs</a><ul>
<li class="chapter" data-level="28.1" data-path="population-graphs.html"><a href="population-graphs.html#adding-data-to-a-graph"><i class="fa fa-check"></i><b>28.1</b> Adding data to a graph</a><ul>
<li class="chapter" data-level="28.1.1" data-path="population-graphs.html"><a href="population-graphs.html#plotting-a-graph-using-ggplot2-routines"><i class="fa fa-check"></i><b>28.1.1</b> Plotting a graph using <strong>ggplot2</strong> routines</a></li>
<li class="chapter" data-level="28.1.2" data-path="population-graphs.html"><a href="population-graphs.html#reading-existing-popgraph-files"><i class="fa fa-check"></i><b>28.1.2</b> Reading Existing <strong>popgraph</strong> Files</a></li>
<li class="chapter" data-level="28.1.3" data-path="population-graphs.html"><a href="population-graphs.html#saving-population-graph-objects"><i class="fa fa-check"></i><b>28.1.3</b> Saving Population Graph Objects</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="population-graphs.html"><a href="population-graphs.html#interactive-networks"><i class="fa fa-check"></i><b>28.2</b> Interactive Networks</a></li>
<li class="chapter" data-level="28.3" data-path="population-graphs.html"><a href="population-graphs.html#spatial-population-graphs"><i class="fa fa-check"></i><b>28.3</b> Spatial Population Graphs</a><ul>
<li class="chapter" data-level="28.3.1" data-path="population-graphs.html"><a href="population-graphs.html#integrating-google-and-ggplot2-for-plotting"><i class="fa fa-check"></i><b>28.3.1</b> Integrating Google and <strong>ggplot2</strong> for Plotting</a></li>
<li class="chapter" data-level="28.3.2" data-path="population-graphs.html"><a href="population-graphs.html#integrating-raster-maps"><i class="fa fa-check"></i><b>28.3.2</b> Integrating Raster Maps</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="population-graphs.html"><a href="population-graphs.html#extracting-spatial-data-using-population-graphs"><i class="fa fa-check"></i><b>28.4</b> Extracting Spatial Data Using Population Graphs</a><ul>
<li class="chapter" data-level="28.4.1" data-path="population-graphs.html"><a href="population-graphs.html#node-specific-data"><i class="fa fa-check"></i><b>28.4.1</b> Node Specific Data</a></li>
<li class="chapter" data-level="28.4.2" data-path="population-graphs.html"><a href="population-graphs.html#extracting-data-along-popgraph-edges"><i class="fa fa-check"></i><b>28.4.2</b> Extracting Data Along Popgraph Edges</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="population-graphs.html"><a href="population-graphs.html#extracting-graph-theoretic-parameters"><i class="fa fa-check"></i><b>28.5</b> Extracting Graph-Theoretic Parameters</a><ul>
<li class="chapter" data-level="28.5.1" data-path="population-graphs.html"><a href="population-graphs.html#matrix-representations-of-population-graph-objects"><i class="fa fa-check"></i><b>28.5.1</b> Matrix Representations of Population Graph Objects</a></li>
<li class="chapter" data-level="28.5.2" data-path="population-graphs.html"><a href="population-graphs.html#node-specific-parameters"><i class="fa fa-check"></i><b>28.5.2</b> Node Specific Parameters</a></li>
<li class="chapter" data-level="28.5.3" data-path="population-graphs.html"><a href="population-graphs.html#edge-specific-parameters"><i class="fa fa-check"></i><b>28.5.3</b> Edge Specific Parameters</a></li>
</ul></li>
<li class="chapter" data-level="28.6" data-path="population-graphs.html"><a href="population-graphs.html#testing-for-topological-congruence"><i class="fa fa-check"></i><b>28.6</b> Testing for Topological Congruence</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="interactive-visualization.html"><a href="interactive-visualization.html"><i class="fa fa-check"></i><b>29</b> Interactive Visualization</a><ul>
<li class="chapter" data-level="29.1" data-path="interactive-visualization.html"><a href="interactive-visualization.html#procedure-1"><i class="fa fa-check"></i><b>29.1</b> Procedure</a><ul>
<li class="chapter" data-level="29.1.1" data-path="interactive-visualization.html"><a href="interactive-visualization.html#interactive-networks-1"><i class="fa fa-check"></i><b>29.1.1</b> Interactive Networks</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Spatial Data</b></span></li>
<li class="chapter" data-level="30" data-path="vector-data.html"><a href="vector-data.html"><i class="fa fa-check"></i><b>30</b> Vector Data</a><ul>
<li class="chapter" data-level="30.1" data-path="vector-data.html"><a href="vector-data.html#points"><i class="fa fa-check"></i><b>30.1</b> Points</a></li>
<li class="chapter" data-level="30.2" data-path="vector-data.html"><a href="vector-data.html#lines"><i class="fa fa-check"></i><b>30.2</b> Lines</a></li>
<li class="chapter" data-level="30.3" data-path="vector-data.html"><a href="vector-data.html#polygons"><i class="fa fa-check"></i><b>30.3</b> Polygons</a></li>
<li class="chapter" data-level="30.4" data-path="vector-data.html"><a href="vector-data.html#saving-vector-objects"><i class="fa fa-check"></i><b>30.4</b> Saving Vector Objects</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="raster-data.html"><a href="raster-data.html"><i class="fa fa-check"></i><b>31</b> Raster Data</a><ul>
<li class="chapter" data-level="31.1" data-path="raster-data.html"><a href="raster-data.html#cropping-rasters"><i class="fa fa-check"></i><b>31.1</b> Cropping Rasters</a><ul>
<li class="chapter" data-level="31.1.1" data-path="raster-data.html"><a href="raster-data.html#cropping-rasters-via-polygons"><i class="fa fa-check"></i><b>31.1.1</b> Cropping Rasters Via Polygons</a></li>
<li class="chapter" data-level="31.1.2" data-path="raster-data.html"><a href="raster-data.html#cropping-rasters-via-convex-hull"><i class="fa fa-check"></i><b>31.1.2</b> Cropping Rasters Via Convex Hull</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="raster-data.html"><a href="raster-data.html#modifying-rasters"><i class="fa fa-check"></i><b>31.2</b> Modifying Rasters</a></li>
<li class="chapter" data-level="31.3" data-path="raster-data.html"><a href="raster-data.html#extracting-point-data-from-rasters"><i class="fa fa-check"></i><b>31.3</b> Extracting Point Data From Rasters</a><ul>
<li class="chapter" data-level="31.3.1" data-path="raster-data.html"><a href="raster-data.html#stacks-of-rasters"><i class="fa fa-check"></i><b>31.3.1</b> Stacks of Rasters</a></li>
</ul></li>
<li class="chapter" data-level="31.4" data-path="raster-data.html"><a href="raster-data.html#rasters-ggplot"><i class="fa fa-check"></i><b>31.4</b> Rasters &amp; ggplot</a></li>
<li class="chapter" data-level="31.5" data-path="raster-data.html"><a href="raster-data.html#d-visualization"><i class="fa fa-check"></i><b>31.5</b> 3D Visualization</a></li>
<li class="chapter" data-level="31.6" data-path="raster-data.html"><a href="raster-data.html#saving-exporting-rasters"><i class="fa fa-check"></i><b>31.6</b> Saving &amp; Exporting Rasters</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="map-projections.html"><a href="map-projections.html"><i class="fa fa-check"></i><b>32</b> Map Projections</a><ul>
<li class="chapter" data-level="32.1" data-path="map-projections.html"><a href="map-projections.html#projections"><i class="fa fa-check"></i><b>32.1</b> Projections</a><ul>
<li class="chapter" data-level="32.1.1" data-path="map-projections.html"><a href="map-projections.html#equatorial-projections"><i class="fa fa-check"></i><b>32.1.1</b> Equatorial Projections</a></li>
<li class="chapter" data-level="32.1.2" data-path="map-projections.html"><a href="map-projections.html#azimuth-projections"><i class="fa fa-check"></i><b>32.1.2</b> Azimuth Projections</a></li>
<li class="chapter" data-level="32.1.3" data-path="map-projections.html"><a href="map-projections.html#polar-conic-projections"><i class="fa fa-check"></i><b>32.1.3</b> Polar Conic Projections</a></li>
<li class="chapter" data-level="32.1.4" data-path="map-projections.html"><a href="map-projections.html#miscellaneous-projections"><i class="fa fa-check"></i><b>32.1.4</b> Miscellaneous Projections</a></li>
<li class="chapter" data-level="32.1.5" data-path="map-projections.html"><a href="map-projections.html#reprojecting-rasters"><i class="fa fa-check"></i><b>32.1.5</b> Reprojecting Rasters</a></li>
<li class="chapter" data-level="32.1.6" data-path="map-projections.html"><a href="map-projections.html#projecting-in-ggplot"><i class="fa fa-check"></i><b>32.1.6</b> Projecting In GGPlot</a></li>
</ul></li>
<li class="chapter" data-level="32.2" data-path="map-projections.html"><a href="map-projections.html#coordinate-systems"><i class="fa fa-check"></i><b>32.2</b> Coordinate Systems</a><ul>
<li class="chapter" data-level="32.2.1" data-path="map-projections.html"><a href="map-projections.html#changing-datum"><i class="fa fa-check"></i><b>32.2.1</b> Changing Datum</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="ecological-distance.html"><a href="ecological-distance.html"><i class="fa fa-check"></i><b>33</b> Ecological Distance</a><ul>
<li class="chapter" data-level="33.1" data-path="ecological-distance.html"><a href="ecological-distance.html#the-concept-of-resistance"><i class="fa fa-check"></i><b>33.1</b> The Concept of Resistance</a><ul>
<li class="chapter" data-level="33.1.1" data-path="ecological-distance.html"><a href="ecological-distance.html#absolute-resistance"><i class="fa fa-check"></i><b>33.1.1</b> Absolute Resistance</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="ecological-distance.html"><a href="ecological-distance.html#relative-resistance"><i class="fa fa-check"></i><b>33.2</b> Relative Resistance</a></li>
<li class="chapter" data-level="33.3" data-path="ecological-distance.html"><a href="ecological-distance.html#estimating-separation"><i class="fa fa-check"></i><b>33.3</b> Estimating Separation</a><ul>
<li class="chapter" data-level="33.3.1" data-path="ecological-distance.html"><a href="ecological-distance.html#least-cost-distance"><i class="fa fa-check"></i><b>33.3.1</b> Least Cost Distance</a></li>
<li class="chapter" data-level="33.3.2" data-path="ecological-distance.html"><a href="ecological-distance.html#all-paths-circuit-distance"><i class="fa fa-check"></i><b>33.3.2</b> All Paths (Circuit) Distance</a></li>
<li class="chapter" data-level="33.3.3" data-path="ecological-distance.html"><a href="ecological-distance.html#path-corridor-constraints"><i class="fa fa-check"></i><b>33.3.3</b> Path &amp; Corridor Constraints</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="ecological-distance.html"><a href="ecological-distance.html#estimating-correlations-in-distance"><i class="fa fa-check"></i><b>33.4</b> Estimating Correlations in Distance</a><ul>
<li class="chapter" data-level="33.4.1" data-path="ecological-distance.html"><a href="ecological-distance.html#pairwise-least-cost-path"><i class="fa fa-check"></i><b>33.4.1</b> Pairwise Least Cost Path</a></li>
<li class="chapter" data-level="33.4.2" data-path="ecological-distance.html"><a href="ecological-distance.html#pairwise-all-pairs"><i class="fa fa-check"></i><b>33.4.2</b> Pairwise All Pairs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="niche-modeling.html"><a href="niche-modeling.html"><i class="fa fa-check"></i><b>34</b> Niche Modeling</a></li>
<li class="chapter" data-level="35" data-path="eigenvector-maps.html"><a href="eigenvector-maps.html"><i class="fa fa-check"></i><b>35</b> Eigenvector Maps</a></li>
<li class="part"><span><b>VII Selection</b></span></li>
<li class="chapter" data-level="36" data-path="classical-selection-models.html"><a href="classical-selection-models.html"><i class="fa fa-check"></i><b>36</b> Classical Selection Models</a><ul>
<li class="chapter" data-level="36.1" data-path="classical-selection-models.html"><a href="classical-selection-models.html#the-strength-of-selection"><i class="fa fa-check"></i><b>36.1</b> The Strength of Selection</a></li>
</ul></li>
<li class="part"><span><b>VIII Backmatter</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="37" data-path="included-data-sets.html"><a href="included-data-sets.html"><i class="fa fa-check"></i><b>37</b> Included Data Sets</a><ul>
<li class="chapter" data-level="37.1" data-path="included-data-sets.html"><a href="included-data-sets.html#the-sonoran-desert-bark-beetle-araptus-attenuata"><i class="fa fa-check"></i><b>37.1</b> The Sonoran desert bark beetle, <em>Araptus attenuata</em></a><ul>
<li class="chapter" data-level="37.1.1" data-path="included-data-sets.html"><a href="included-data-sets.html#nuclear-markers"><i class="fa fa-check"></i><b>37.1.1</b> Nuclear Markers</a></li>
<li class="chapter" data-level="37.1.2" data-path="included-data-sets.html"><a href="included-data-sets.html#methylation-markers"><i class="fa fa-check"></i><b>37.1.2</b> Methylation Markers</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="included-data-sets.html"><a href="included-data-sets.html#the-flowering-dogwood-cornus-florida"><i class="fa fa-check"></i><b>37.2</b> The Flowering Dogwood <em>Cornus florida</em></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="divider"></li>
<li><a href="http://dyerlab.bio.vcu.edu" target="blank">the Dyer Laboratory</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Population Genetics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="population-graphs" class="section level1 imageChapter">
<h1><span class="header-section-number">28</span> Population Graphs</h1>
<div class="chapter_image">
<img src="chapter_images/ch_euphorbia.jpg">
</div>
<p>Population Graphs are a statistical representation of among population genetic variance, <span class="math inline">\(\sigma^2_A\)</span>, as viewed through a network (Dyer &amp; Nason 2004). A population graph is a graph-theoretic interpretation of genetic covariance and serves as a tool for understanding underlying evolutionary history for a set of populations.</p>
<p>These structures are estimated in R using the <strong>popgraphs</strong> library.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(popgraph)</code></pre></div>
<p>As other networks, a population graph is a graph-theoretic structure that can be represetendHere we will focus on the former approach as it is native to this package. If you use the latter one, it will produce a *.pgraph file and you can read it in using the <code>read_popgraph()</code> function.</p>
<div id="adding-data-to-a-graph" class="section level2">
<h2><span class="header-section-number">28.1</span> Adding data to a graph</h2>
<p>A population graph is made more informative if you can associate some data with topology. External data may be spatial or ecolgoical data associated with each node. Edge data may be a bit more complicated as it is traversing both spatial and ecolgoical gradients and below we’ll see how to extract particular from rasters using edge crossings.</p>
<p>Included in the <em>popgraph</em> package are some build-in data sets to illustrate some of the utility. Included is the cactus topology that was originally used to develop this approach (from Dyer &amp; Nason 2004).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(lopho)
<span class="kw">class</span>(lopho)</code></pre></div>
<pre><code>## [1] &quot;popgraph&quot; &quot;igraph&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lopho</code></pre></div>
<pre><code>## IGRAPH UNW- 21 52 -- 
## + attr: name (v/c), size (v/n), color (v/c), Region (v/c), weight
## | (e/n)
## + edges (vertex names):
##  [1] BaC--LaV    BaC--Lig    BaC--PtC    BaC--PtP    BaC--SnE   
##  [6] BaC--SnI    BaC--StR    Ctv--PtP    Ctv--SLG    Ctv--SnF   
## [11] Ctv--SenBas LaV--Lig    LaV--PtC    LaV--SnE    LaV--SnF   
## [16] LaV--TsS    Lig--PtC    Lig--SnI    Lig--StR    Lig--TsS   
## [21] PtC--SnE    PtC--StR    PtC--TsS    PtC--SenBas PtP--SnF   
## [26] PtP--SnI    PtP--SenBas SLG--SnF    SLG--SnI    SnE--StR   
## [31] SnE--TsS    SnF--SnI    SnI--StR    StR--TsS    StR--SenBas
## + ... omitted several edges</code></pre>
<p>We can associate data with the nodes using the <code>decorate_graph()</code> function. This takes a <code>data.frame</code> object and tries to match up the columns of data in the data.frame to the nodes. Here is an example with some addition built-in data. The option <code>stratum</code> indicates the name of the column that has the node labels in it (which are stored as <code>V(graph)$name</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(baja)
<span class="kw">summary</span>(baja)</code></pre></div>
<pre><code>##     Region     Population    Latitude       Longitude     
##  Baja  :16   BaC    : 1   Min.   :22.93   Min.   :-114.7  
##  Sonora:13   Cabo   : 1   1st Qu.:24.45   1st Qu.:-112.6  
##              CP     : 1   Median :27.95   Median :-111.8  
##              Ctv    : 1   Mean   :27.33   Mean   :-111.8  
##              ELR    : 1   3rd Qu.:29.59   3rd Qu.:-110.7  
##              IC     : 1   Max.   :31.95   Max.   :-109.5  
##              (Other):23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lopho &lt;-<span class="st"> </span><span class="kw">decorate_graph</span>( lopho, baja, <span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>)
lopho</code></pre></div>
<pre><code>## IGRAPH UNW- 21 52 -- 
## + attr: name (v/c), size (v/n), color (v/c), Region (v/c),
## | Latitude (v/n), Longitude (v/n), weight (e/n)
## + edges (vertex names):
##  [1] BaC--LaV    BaC--Lig    BaC--PtC    BaC--PtP    BaC--SnE   
##  [6] BaC--SnI    BaC--StR    Ctv--PtP    Ctv--SLG    Ctv--SnF   
## [11] Ctv--SenBas LaV--Lig    LaV--PtC    LaV--SnE    LaV--SnF   
## [16] LaV--TsS    Lig--PtC    Lig--SnI    Lig--StR    Lig--TsS   
## [21] PtC--SnE    PtC--StR    PtC--TsS    PtC--SenBas PtP--SnF   
## [26] PtP--SnI    PtP--SenBas SLG--SnF    SLG--SnI    SnE--StR   
## [31] SnE--TsS    SnF--SnI    SnI--StR    StR--TsS    StR--SenBas
## + ... omitted several edges</code></pre>
<p>Each vertex now has seveal different types of data associated with it now. We will use this below.</p>
<div id="plotting-a-graph-using-ggplot2-routines" class="section level3">
<h3><span class="header-section-number">28.1.1</span> Plotting a graph using <strong>ggplot2</strong> routines</h3>
<p>The <strong>ggplot2</strong> package provides a spectacular plotting environment in an intuitive context and there are now some functions to support the Population Graphs in this context.</p>
<p>If you haven’t used <strong>ggplot2</strong> before, it may at first be a bit odd because it deviates from normal plotting approaches where you just shove a bunch of arguments into a single plotting function. In <strong>ggplot</strong>, you build a graphic in the same way you build a regression equation. A regression equation has an intercept and potentially a bunch of independent terms. This is exactly how <strong>ggplot</strong> builds plots, by adding togther components.</p>
<p>To specifiy how things look in a plot, you need to specify an aesthetic using the <code>aes()</code> funciton. Here is where you supply the variable names you use for coordinate, coloring, shape, etc. For both of the <code>geom_*set</code> funcitons, these names <strong>must</strong> be attributes of either the node or edge sets in the graph itself.</p>
<p>Here is an example using the <em>Lopohcereus</em> graph. We begin by making a <code>ggplot()</code> object and then adding to it a <code>geom_</code> object. The 5<strong>popgraph</strong> package comes with two funcitons, one for edges and one for nodes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>() 
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_edgeset</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude,<span class="dt">y=</span>Latitude), lopho ) 
p</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
<p>I broke up the plotting into several lines to improve readability, it is not necessary to to this in practice though. The addition of additional <code>geom_</code> objects to the plot will layer them on top (n.b., I also passed the <em>size=4</em> option to the plot as the default point size is a bit too small and this is how you could change that).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p +<span class="st">  </span><span class="kw">geom_nodeset</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude, <span class="dt">y=</span>Latitude), lopho, <span class="dt">size=</span><span class="dv">4</span>)
p</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-459-1.png" width="672" /></p>
<p>And then you can add additional options to the plot, like axis labels and a less exciting background theme (the <code>theme_empty()</code> provided by <strong>popgraph</strong> is actually transparent so you can save the image and throw it into a presentation as necessary).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="kw">geom_edgeset</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude,<span class="dt">y=</span>Latitude), lopho, <span class="dt">color=</span><span class="st">&quot;darkgrey&quot;</span> )
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_nodeset</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude, <span class="dt">y=</span>Latitude, <span class="dt">color=</span>Region, <span class="dt">size=</span>size), lopho) 
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Latitude&quot;</span>) 
p +<span class="st"> </span><span class="kw">theme_empty</span>()</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-460-1.png" width="672" /></p>
<p>You can also use the default layout routines in <em>igraph</em> for visualization. Here is an example using Fruchterman-Reingold algorithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(igraph)
c &lt;-<span class="st"> </span><span class="kw">layout.fruchterman.reingold</span>( lopho )
<span class="kw">V</span>(lopho)$x &lt;-<span class="st"> </span>c[,<span class="dv">1</span>]
<span class="kw">V</span>(lopho)$y &lt;-<span class="st"> </span>c[,<span class="dv">2</span>]
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>() +<span class="st"> </span><span class="kw">geom_edgeset</span>( <span class="kw">aes</span>(x,y), lopho, <span class="dt">color=</span><span class="st">&quot;darkgrey&quot;</span> )
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_nodeset</span>( <span class="kw">aes</span>(x, y, <span class="dt">color=</span>Region, <span class="dt">size=</span>size), lopho) 
p +<span class="st"> </span><span class="kw">theme_empty</span>()</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-461-1.png" width="672" /></p>
</div>
<div id="reading-existing-popgraph-files" class="section level3">
<h3><span class="header-section-number">28.1.2</span> Reading Existing <strong>popgraph</strong> Files</h3>
<p>The online versions of Population Graphs provides a *.pgraph file for visualization. These files are visualized in several different software platforms including GeneticStudio (Dyer 2009), a OpenGL visualization application (Dyer &amp; Nason 2004), an online visualization framework at <a href="http://dyerlab.bio.vcu.edu" class="uri">http://dyerlab.bio.vcu.edu</a>, and of course, in R. We shall focus on this last one. Reading in files to R</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph &lt;-<span class="st"> </span><span class="kw">read.popgraph</span>( <span class="st">&quot;thegraph.pgraph&quot;</span> )</code></pre></div>
</div>
<div id="saving-population-graph-objects" class="section level3">
<h3><span class="header-section-number">28.1.3</span> Saving Population Graph Objects</h3>
<p>A <strong>popgraph</strong> object is a normal R object and can be saved using the normal R mechanisms.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>( lopho, <span class="dt">file=</span><span class="st">&quot;MyLophoGraph.rda&quot;</span>)</code></pre></div>
<p>For interoperability, <strong>popgraph</strong> objects can also be saved in other formats. These are accessed through the <code>write.popgraph()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.popgraph</span>(lopho,<span class="dt">file=</span><span class="st">&quot;~/Desktop/Cactus.pgraph&quot;</span>, <span class="dt">format=</span><span class="st">&quot;pgraph&quot;</span>)</code></pre></div>
<p>There are several other options available for outputing your graph. Currently the other formats that have been implemented are:</p>
<ol style="list-style-type: decimal">
<li><code>json</code> A format for html javascript data processing.<br />
</li>
</ol>
<ul>
<li><code>kml</code> The Keyhole Markup Language which is read by GoogleEarth. This requires <code>Latitude</code> and <code>Longtitude</code> vertex properties.</li>
<li><code>graphml</code> The graph markup language.</li>
<li><code>html</code> Export as an interactive html document you can manipulate on your desktop (uses javascript d3.js library so you need an internet connection).</li>
<li><code>pajek</code> Export to a format that works with the software Pajek (<a href="http://pajek.imfm.si/doku.php?id=pajek" class="uri">http://pajek.imfm.si/doku.php?id=pajek</a>)</li>
<li><code>pgraph</code> The format used in GeneticStudio and the original popgraph 3D viewer (this is the default).</li>
<li><code>adjacency</code> Saves the adjacency matrix of the graph (binary) as a CSV file</li>
<li><code>paths</code> Saves the shortest paths matrix as a CSV file</li>
<li><code>weights</code> Saves the adjacency matrix with edge weights.</li>
</ul>
</div>
</div>
<div id="interactive-networks" class="section level2">
<h2><span class="header-section-number">28.2</span> Interactive Networks</h2>
<p>To create a popgraph, you need to pass the <code>popgraph()</code> function genotypes as multivariate variables—the function <code>to_mv()</code> does this behind the scene—and a vector of variables that allocate each row of data to a node. Here we use the ‘Population’ vector from the arapat <code>data.frame</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
<span class="kw">library</span>(popgraph)
<span class="kw">data</span>(arapat)
graph &lt;-<span class="st"> </span><span class="kw">popgraph</span>(<span class="kw">to_mv</span>(arapat),<span class="dt">groups =</span> arapat$Population)
<span class="kw">print</span>(graph)</code></pre></div>
<pre><code>## IGRAPH UNW- 39 71 -- 
## + attr: name (v/c), size (v/n), weight (e/n)
## + edges (vertex names):
##  [1] 101--102   101--32    102--32    12 --161   12 --165   12 --93   
##  [7] 153--165   153--58    156--157   156--48    156--73    156--75   
## [13] 157--48    157--Aqu   157--ESan  159--171   159--173   159--89   
## [19] 160--168   160--169   160--93    160--SFr   161--162   161--165  
## [25] 161--93    161--SFr   162--64    162--77    162--93    163--75   
## [31] 163--Const 163--ESan  164--165   164--169   164--51    164--Const
## [37] 164--SFr   165--168   165--169   165--77    166--168   168--51   
## [43] 168--58    168--64    168--77    169--58    169--93    169--SFr  
## + ... omitted several edges</code></pre>
<p>The <code>forceNetwork()</code> function is what does the plotting and it needs some data that are in a specific format. Essentially, there needs to be two <code>data.frame</code> objects with the following attributes:</p>
<ul>
<li><strong>nodes</strong> - A <code>data.frame</code> with each row representing the name of the node to be displayed, the group the node belongs to (if there are groupings of nodes to be displayed by alternative colors), and a vector of node sizes.<br />
</li>
<li><strong>edges</strong> - A <code>data.frame</code> representing the edge connecting the nodes, labeled as ‘from’ and ‘to’ and a vector of weights.</li>
</ul>
<p>The ‘from’ and ‘to’ vectors need to be numeric values of the nodes in the other data frame <strong>and</strong> need to be 0-indexed (e.g., the first node name it is going to look up is indexed as ‘0’ in the javascript instead of ‘1’ as is common in R).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nodes &lt;-<span class="st"> </span><span class="kw">to_data.frame</span>( graph, <span class="dt">mode=</span><span class="st">&quot;nodes&quot;</span>, <span class="dt">as.named=</span><span class="ot">FALSE</span> )
edges &lt;-<span class="st"> </span><span class="kw">to_data.frame</span>( graph, <span class="dt">mode=</span><span class="st">&quot;edges&quot;</span>, <span class="dt">as.named=</span><span class="ot">FALSE</span> )
edges$source &lt;-<span class="st"> </span>edges$source -<span class="st"> </span><span class="dv">1</span>
edges$target &lt;-<span class="st"> </span>edges$target -<span class="st"> </span><span class="dv">1</span> </code></pre></div>
<p>The only last thing to do is to define a grouping of populations. This will be represented in the network as a coloring. For this one, I’m going to use the hypothesized STRUCTURE clustering (see <a href="admixture.html#admixture">23</a> for how this was done). In the <code>arapat</code> data set, there is a designation for each individual on which cluster they belong. Some populations are ‘pure’ in their groupings but others (in spatial regions of sympatry) they are mixed. Below I determine the estimated STRUCTURE groups for each population and collapse those who have more than one into a single string.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grps &lt;-<span class="st"> </span><span class="kw">by</span>( arapat$Cluster, arapat$Population, unique )
l &lt;-<span class="st"> </span><span class="kw">lapply</span>( grps, function(x) { g &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">sort</span>(x),<span class="dt">collapse=</span><span class="st">&quot;/&quot;</span>) })
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">name=</span><span class="kw">names</span>(l), <span class="dt">group=</span><span class="kw">as.character</span>(l))
nodes &lt;-<span class="st"> </span><span class="kw">merge</span>( nodes, df )</code></pre></div>
<p>Once defined, we can then call the function to make the <code>data.frame</code> objects and then do the plot. These graphics are <em>interactive</em>, grab a node and drag it around!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(networkD3)
<span class="kw">forceNetwork</span>(<span class="dt">Links =</span> edges, <span class="dt">Nodes =</span> nodes,
            <span class="dt">Source =</span> <span class="st">&quot;source&quot;</span>, <span class="dt">Target =</span> <span class="st">&quot;target&quot;</span>,
            <span class="dt">Value =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">NodeID =</span> <span class="st">&quot;name&quot;</span>,
            <span class="dt">Group =</span> <span class="st">&quot;group&quot;</span>, <span class="dt">opacity=</span><span class="fl">1.0</span>,
            <span class="dt">legend=</span><span class="ot">TRUE</span>, <span class="dt">fontSize =</span> <span class="dv">16</span>,
            <span class="dt">zoom=</span><span class="ot">TRUE</span> )</code></pre></div>
<div id="htmlwidget-6297c4c1f10e238146da" style="width:672px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-6297c4c1f10e238146da">{"x":{"links":{"source":[0,0,1,2,2,2,3,3,4,4,4,4,5,5,5,6,6,6,7,7,7,7,8,8,8,8,9,9,9,10,10,10,11,11,11,11,11,12,12,12,13,14,14,14,14,15,15,15,16,16,17,18,18,19,19,21,22,23,24,24,25,25,25,27,28,28,28,29,32,33,34],"target":[1,20,20,8,12,32,12,23,5,21,25,26,21,34,36,16,17,30,14,15,32,38,9,12,32,38,24,27,32,26,35,36,12,15,22,35,38,14,15,27,14,22,23,24,27,23,32,38,17,18,30,19,29,29,31,36,23,38,27,38,26,34,36,32,29,30,31,31,38,37,36],"value":[8.45324671861479,11.3392934536416,12.362907286415,2.90432059242197,3.53104375426366,2.95907651440433,4.01936959972293,1.22917316036238,4.03245913683025,5.12419089808696,5.02121609605313,5.78348393054996,4.35040106460888,4.73488748210723,3.76005223133308,2.84376688249322,2.89614187678504,4.16572420527594,3.85617041124065,2.70207873507271,2.91697233762107,2.93265079330762,3.31649675878596,3.11692197360928,2.50373688639928,2.78976954662207,6.19795399169884,4.93245306852763,3.29009085293472,9.51832446611555,8.24035213457151,8.36864126827799,4.24795854776905,3.71002063341606,5.87479501991043,4.67765457155976,5.81109654957986,3.33489401772702,2.85506964665014,4.37837128931742,4.00335783307894,5.89050582196516,3.98073711030734,4.40361382730534,5.05214719304513,2.93645031235043,2.6340580477165,2.63342673975013,2.72117328085347,3.18304152193125,3.23348171031955,1.84258746362757,3.63957775022367,2.99650028760203,3.17634016214171,3.4849260827623,4.98332507330648,3.56433514791232,7.35584476681317,4.4480950761091,3.65872754021918,3.69526146781118,3.6283788722433,3.93301088197976,4.49124569905757,7.54705626431276,4.40780576409764,3.33802592490648,2.38236384351171,4.19608147299158,3.80626949664509],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["101","102","12","153","156","157","159","160","161","162","163","164","165","166","168","169","171","173","175","177","32","48","51","58","64","73","75","77","84","88","89","9","93","98","Aqu","Const","ESan","Mat","SFr"],"group":["SON-B","SON-B","CBP-C","CBP-C","SCBP-A","SBP-C/SCBP-A","NBP-C","CBP-C","CBP-C","CBP-C","SBP-C/SCBP-A","CBP-C/SCBP-A","CBP-C","CBP-C/SCBP-A","CBP-C","CBP-C","NBP-C","NBP-C","NBP-C","NBP-C","SON-B","SCBP-A","CBP-C","CBP-C","CBP-C","SBP-C/SCBP-A","SBP-C/SCBP-A","CBP-C/SCBP-A","NBP-C","NBP-C","NBP-C","NBP-C","CBP-C","SBP-C/SCBP-A","CBP-C/SBP-C/SCBP-A","CBP-C/SCBP-A","SBP-C/SCBP-A","CBP-C/SCBP-A","CBP-C"]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":16,"fontFamily":"serif","clickTextSize":40,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-120,"opacity":1,"zoom":true,"legend":true,"nodesize":false,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="spatial-population-graphs" class="section level2">
<h2><span class="header-section-number">28.3</span> Spatial Population Graphs</h2>
<p>Mapping the nodes and edges onto real space is a key task in the understanding of how covariance is partitioned on the landscape. There are several approaches that can be used in R since it is such a flexible platform. In what follows I will use a series of techniques that I find useful ordered from the simplest to the more complicated.</p>
<div id="integrating-google-and-ggplot2-for-plotting" class="section level3">
<h3><span class="header-section-number">28.3.1</span> Integrating Google and <strong>ggplot2</strong> for Plotting</h3>
<p>R has some pretty good facilities for using spatial assests from Google and OpenStreetMaps and is a very easy way to get quick plots from Population Graphs, particularly if you can integrate it into the <strong>ggplot2</strong> framework.</p>
<p>Using the <strong>ggmap</strong> package, you can request map tiles and use as backgrounds onto which you can plot specific objects. To do so, you must first get:</p>
<ul>
<li>Either the centroid of the location you are interested in finding and a value of zoom (just like in google maps), or</li>
<li>A bounding box with left, bottom, right, top coordinates. This is a bit of an experimental thing and does not always get you what you want.</li>
</ul>
<p>Some fiddling is required with either way you go. The map you get from <code>get_map()</code> is essentially a huge matrix of hex colors as shown above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap)
location &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">mean</span>(<span class="kw">V</span>(lopho)$Longitude), <span class="kw">mean</span>(<span class="kw">V</span>(lopho)$Latitude))
location</code></pre></div>
<pre><code>## [1] -112.17571   27.91048</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map &lt;-<span class="st"> </span><span class="kw">get_map</span>(location,<span class="dt">maptype=</span><span class="st">&quot;satellite&quot;</span>, <span class="dt">zoom=</span><span class="dv">6</span>)
<span class="kw">dim</span>(map)</code></pre></div>
<pre><code>## [1] 1280 1280</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map[<span class="dv">1</span>:<span class="dv">4</span>,<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]      [,4]     
## [1,] &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#3C5283&quot;
## [2,] &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#405285&quot;
## [3,] &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#40558A&quot; &quot;#40558A&quot;
## [4,] &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#3C5283&quot; &quot;#40558A&quot;</code></pre>
<p>This map object can be passed on to <code>ggmap()</code>, which replaces the traditional <code>ggplot()</code> funciton and sets up the bounding box in terms of Latitude and Longtidue. Onto this, you can plot the graph topologoy using:</p>
<ul>
<li><code>geom_edgeset()</code> This takes the graph and plots out the edges.<br />
</li>
<li><code>geom_nodeset()</code> This plots out the nodes. You could probably use a regular <em>data.frame</em> and <code>geom_point()</code> as well. Here is an example:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggmap</span>( map ) 
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_edgeset</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude,<span class="dt">y=</span>Latitude), lopho, <span class="dt">color=</span><span class="st">&quot;white&quot;</span> ) 
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_nodeset</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude, <span class="dt">y=</span>Latitude, <span class="dt">color=</span>Region, <span class="dt">size=</span>size), lopho) 
p +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Latitude&quot;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-469-1.png" width="672" /></p>
</div>
<div id="integrating-raster-maps" class="section level3">
<h3><span class="header-section-number">28.3.2</span> Integrating Raster Maps</h3>
<p>At times we have raster data upon we can plot a population graph. Here is an example from Baja California. The underlying raster image is croped from a WorldClim tile and represents elevation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)
<span class="kw">data</span>(alt)
<span class="kw">plot</span>(alt)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-470-1.png" width="672" /></p>
<p>Since it is a <strong>raster</strong> object, it knows how to plot itself relatively well. There are a ton of good references for showing you how to play with raster data (e.g., Bivand <em>et al.</em> 2008)</p>
<p>To plot our graph onto this topology, we export the spatial components of the graph into objects that interact with rasters. The packages provides simple extraction of features into <code>SpatialLines</code> and <code>SpatialPoints</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lopho.nodes &lt;-<span class="st"> </span><span class="kw">to_SpatialPoints</span>(lopho)
lopho.nodes</code></pre></div>
<pre><code>## class       : SpatialPoints 
## features    : 21 
## extent      : -114.73, -109.99, 23.58, 31.95  (xmin, xmax, ymin, ymax)
## coord. ref. : NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lopho.edges &lt;-<span class="st"> </span><span class="kw">to_SpatialLines</span>(lopho)
<span class="kw">head</span>(lopho.edges)</code></pre></div>
<pre><code>## class       : SpatialLines 
## features    : 1 
## extent      : -111.79, -109.99, 24.04, 26.59  (xmin, xmax, ymin, ymax)
## coord. ref. : NA</code></pre>
<p>Once we have them extracted into the right format, we can add them to the raster plot. I plot the nodes twice to overlay a circular icon (<code>pch=16</code>) onto the default cross marker and make them 50 % larger (<code>cex=1.5</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( alt )
<span class="kw">plot</span>( lopho.edges, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;#555555&quot;</span> )
<span class="kw">plot</span>( lopho.nodes, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span> )
<span class="kw">plot</span>( lopho.nodes, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="kw">V</span>(lopho)$color, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">1.5</span> )</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-472-1.png" width="768" /></p>
</div>
</div>
<div id="extracting-spatial-data-using-population-graphs" class="section level2">
<h2><span class="header-section-number">28.4</span> Extracting Spatial Data Using Population Graphs</h2>
<p>Since we are dealing with the spatial stuff right now, it makes sense to look into how we can use the topological features of the graph to extract spatial data.</p>
<div id="node-specific-data" class="section level3">
<h3><span class="header-section-number">28.4.1</span> Node Specific Data</h3>
<p>The node data <code>nodes</code> is a <code>SpatialPoints</code> object and can be used to pull data from raster sources. I’ll start by creating a <code>data.frame</code> with some existing data in it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.nodes &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Pop=</span><span class="kw">V</span>(lopho)$name, <span class="dt">Latitude=</span><span class="kw">V</span>(lopho)$Latitude, <span class="dt">Longitude=</span><span class="kw">V</span>(lopho)$Longitude)</code></pre></div>
<p>Then we can extract the elevation from the <code>alt</code> raster as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(raster)
df.nodes$Elevation &lt;-<span class="st"> </span><span class="kw">extract</span>( alt, lopho.nodes )
<span class="kw">summary</span>(df.nodes)</code></pre></div>
<pre><code>##       Pop        Latitude       Longitude        Elevation    
##  BaC    : 1   Min.   :23.58   Min.   :-114.7   Min.   :  5.0  
##  CP     : 1   1st Qu.:25.73   1st Qu.:-112.9   1st Qu.: 14.0  
##  Ctv    : 1   Median :28.82   Median :-112.0   Median : 66.0  
##  LaV    : 1   Mean   :27.91   Mean   :-112.2   Mean   :159.2  
##  LF     : 1   3rd Qu.:29.73   3rd Qu.:-111.3   3rd Qu.:259.0  
##  Lig    : 1   Max.   :31.95   Max.   :-110.0   Max.   :667.0  
##  (Other):15</code></pre>
<p>Additional data could be extracted from other rasters. See <a href="http://worldclim.org" class="uri">http://worldclim.org</a> for some example data that may prove useful.</p>
</div>
<div id="extracting-data-along-popgraph-edges" class="section level3">
<h3><span class="header-section-number">28.4.2</span> Extracting Data Along Popgraph Edges</h3>
<p>It is also possible to extract data along vectors, or other <em>SpatialLines</em> objects, which the edges in a popgraph can be tranformed into. This is a particularly helpful approach if you are trying to quantify the value of characteristics of the environment between your sampling locations. In the following example, I estimate the popualtion graph from the <code>arapat</code> data set</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coords &lt;-<span class="st"> </span><span class="kw">strata_coordinates</span>(arapat)
graph &lt;-<span class="st"> </span><span class="kw">decorate_graph</span>( graph, coords )
edges &lt;-<span class="st"> </span><span class="kw">to_SpatialLines</span>(graph)
<span class="kw">proj4string</span>(edges) &lt;-<span class="st"> </span><span class="kw">CRS</span>( <span class="kw">proj4string</span>( alt ))
<span class="kw">plot</span>( alt, <span class="dt">legend=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(edges,<span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="amg_files/figure-html/popgraphInBaja-1.png" width="672" /></p>
<p>and determine which of the edges has the longest length.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">edge_lengths &lt;-<span class="st"> </span><span class="kw">SpatialLinesLengths</span>( edges )
longest &lt;-<span class="st"> </span><span class="kw">sort</span>( edge_lengths,<span class="dt">decreasing =</span> <span class="ot">TRUE</span> )[<span class="dv">1</span>]
longest</code></pre></div>
<pre><code>## Edge 164 SFr 
##     322.8491</code></pre>
<p>This edge is found at:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idx</code></pre></div>
<pre><code>## Edge 164 SFr 
##           37</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">edge &lt;-<span class="st"> </span>edges[ <span class="dv">37</span> ]
edge</code></pre></div>
<pre><code>## class       : SpatialLines 
## features    : 1 
## extent      : -112.964, -111.5441, 24.74642, 27.3632  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( alt, <span class="dt">legend=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(edge,<span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-476-1.png" width="672" /></p>
<p>From this edge object (or a collection of edge objects) we can again extract values from a raster. Here I pull out the elevation profile of this edge. To plot it, I need to make a sequence of latitude values equal in length to that of the observed elevation values I extracted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">elev &lt;-<span class="st"> </span><span class="kw">extract</span>( alt, edge )[[<span class="dv">1</span>]]
from_lat &lt;-<span class="st"> </span><span class="kw">V</span>(graph)$Latitude[<span class="kw">V</span>(graph)$name ==<span class="st"> &quot;SFr&quot;</span>]
to_lat &lt;-<span class="st"> </span><span class="kw">V</span>(graph)$Latitude[ <span class="kw">V</span>(graph)$name ==<span class="st"> &quot;164&quot;</span>]
lat &lt;-<span class="st"> </span><span class="kw">seq</span>( <span class="dt">from=</span>from_lat, <span class="dt">to=</span>to_lat, <span class="dt">length.out =</span> <span class="kw">length</span>(elev) )
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">Latitude=</span>lat, <span class="dt">Elevation=</span>elev)
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>( df, <span class="kw">aes</span>(Latitude,Elevation)) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&quot;lightgrey&quot;</span>) 
p +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Elevation (m)&quot;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
<p>Population Graphs have been used to determine if there is an preference (or avoidance) of a specific raster value for the location of individual edges on the landscape. For example, Dyer <em>et al.</em> (2012) were interested in determining if there the edge in the pollination graph (e.g., a population graph constructed from male pollen haplotypes) preferentially traverse (or avoid) specific intervening habitat features. To do this, they permuted the edge set among nodes in the graph and recorded the prevalence (mean and variance) of specific features extracted from specific categorical rasters representing both canopy and understory features. The permutation of a network should be done such that you preserve aspects of the spatial heterogeneity and spatial arrangement of the nodes on the landscape. You probably do not want to permute all edges randomly in the graph (though this option is available in the code), but would probably be better served by permuting the network while maintaining both the node coordinates (e.g., where they exist on the landscape) as well as the degree distribution of the overall network. This second criteria holds constant higher network structure. The general idea is to:</p>
<ol style="list-style-type: decimal">
<li>Create a saturated graph and extract ecological features for all potential connections. This gives us a <code>data.frame</code> within which we can pull out ecological values for each permutation. This is the most computationally intensive process and doing it once and then extracting values from the <code>data.frame</code> for each permutation is a more efficient approach.</li>
<li>Once you have all the potential values of your features, you can permute the observed matrix, while holding both the connection probability (e.g., the number of edges) and the degree distribution (e.g., the amount of edges connected to nodes) constant using the <code>randomize_graph</code> function included in the <code>popgraph</code> library. For each permutation, you then compile the permuted environmental factor as a null distribution and then compare those to the observed.</li>
</ol>
<p>This may sound a bit convoluted, but this example may help. Consider the hypothetical case where we think that the edges in the population graph from Figure <a href="#fig:popgraphInBaja"><strong>??</strong></a>, are restricted in elevation because we believe that dispersing insects fly around high elevation mountains rather than over them.<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> If this is true, then we should expect that the average (or max) elevation along any of the observed edges in the Population Graph would be less than what would be expected if we permuted the edges among nodes and measured elevation along edges from permuted graphs.</p>
<p>First, we need to set up the network and extract values of elevation along all potential edges. I make a saturated graph from all potential</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(baja)
graph &lt;-<span class="st"> </span><span class="kw">popgraph</span>( <span class="kw">to_mv</span>( arapat ), arapat$Population )
graph &lt;-<span class="st"> </span><span class="kw">decorate_graph</span>( graph, coords )
allpops &lt;-<span class="st"> </span><span class="kw">V</span>(graph)$name</code></pre></div>
<p>I then can make an adjacency matrix connecting all pairs of populations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw">length</span>(allpops),<span class="dt">ncol=</span><span class="kw">length</span>(allpops))
<span class="kw">diag</span>(A) &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">rownames</span>(A) &lt;-<span class="st"> </span><span class="kw">colnames</span>(A) &lt;-<span class="st"> </span>allpops
saturated_graph &lt;-<span class="st"> </span><span class="kw">graph.adjacency</span>(A, <span class="dt">mode =</span> <span class="st">&quot;undirected&quot;</span>)
saturated_graph &lt;-<span class="st"> </span><span class="kw">as.popgraph</span>( saturated_graph )</code></pre></div>
<p>From which I can pull all the edges (all 741 of them) as <code>SpatialLines</code> objects</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">saturated_graph &lt;-<span class="st"> </span><span class="kw">decorate_graph</span>( saturated_graph, coords )
all_edges &lt;-<span class="st"> </span><span class="kw">to_SpatialLines</span>( saturated_graph )</code></pre></div>
<p>From these 741 <code>SpatialLines</code> objects, we can extract data from the elevation raster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">edge_values &lt;-<span class="st"> </span><span class="kw">extract</span>( alt, all_edges, <span class="dt">fun=</span>max, <span class="dt">na.rm=</span><span class="ot">TRUE</span>, <span class="dt">df=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>This will take a bit of time to complete. The options that I provided were:<br />
- <code>fun=max</code> - The function used is the max function. - <code>na.rm=TRUE</code> - Ignore all missing data (e.g., when an edge crosses water on the <code>alt</code> raster, the extracted values are <code>NA</code>) - <code>df=TRUE</code> - Return the answer as a <code>data.frame</code> object instead of just a vector.</p>
<p>This <code>data.frame</code> has two columns, one for edge number and the other for value. I’m going to put an additional pair of columns with the names of the nodes the edges are connected to into this <code>data.frame</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">edge_names &lt;-<span class="st"> </span><span class="kw">as_edgelist</span>( saturated_graph )
edge_values$Nodes &lt;-<span class="st"> </span><span class="kw">paste</span>( edge_names[,<span class="dv">1</span>], edge_names[,<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>)
<span class="kw">head</span>(edge_values)</code></pre></div>
<pre><code>##   ID alt_22   Nodes
## 1  1     25 101-102
## 2  2    906  101-12
## 3  3     31 101-153
## 4  4     72 101-156
## 5  5   1079 101-157
## 6  6   1361 101-159</code></pre>
<p>This constitutes <em>all potential</em> connections across the landscape. From this we can extract the edges that we observed in the original Population Graph</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span><span class="kw">as_edgelist</span>( graph )
obs &lt;-<span class="st"> </span>edge_values$alt_22[ edge_values$Nodes %in%<span class="st"> </span><span class="kw">paste</span>( e[,<span class="dv">1</span>], e[,<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>) ]
<span class="kw">mean</span>(obs)</code></pre></div>
<pre><code>## [1] 744.5634</code></pre>
<p>We can now permute the network a moderate number of times and take the values of permuted elevation to see if our observed are smaller than all potential elevations for this specific network.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">perm_elev &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="dv">999</span>)
for( i in <span class="dv">1</span>:<span class="kw">length</span>(perm_elev) ) {
  perm_graph &lt;-<span class="st"> </span><span class="kw">randomize_graph</span>( graph )
  e &lt;-<span class="st"> </span><span class="kw">as_edgelist</span>( perm_graph )
  perm_val &lt;-<span class="st"> </span>edge_values$alt_22[ edge_values$Nodes %in%<span class="st"> </span><span class="kw">paste</span>( e[,<span class="dv">1</span>], e[,<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>) ]
  perm_elev[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(perm_val)
}</code></pre></div>
<p>Now, we can see where the observed value occurs in the distribution of elevations created under the null hypothesis of no difference in elevation across edges.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">Elevation=</span><span class="kw">c</span>(<span class="kw">mean</span>(obs),perm_elev), <span class="dt">Category=</span><span class="kw">c</span>(<span class="st">&quot;Observed&quot;</span>,<span class="kw">rep</span>(<span class="st">&quot;Permuted&quot;</span>,<span class="dv">999</span>)))
<span class="kw">ggplot</span>( df, <span class="kw">aes</span>(<span class="dt">x=</span>Elevation,<span class="dt">fill=</span>Category)) +<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">stat=</span><span class="st">&quot;bin&quot;</span>, <span class="dt">bins=</span><span class="dv">40</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Elevation (m)&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Distribution of Permuted Elevations&quot;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
<p>In fact, we can estimate the probablity as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>( <span class="kw">mean</span>(obs) &gt;=<span class="st"> </span>perm_elev )</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>As it turns out, the observed edges do in fact appear to be traversing lower elevations than the potential set of edges that could be present (while controlling for spatial location of populations and graph structure).</p>
<!-------------  XXXXXXX   ---------------->
</div>
</div>
<div id="extracting-graph-theoretic-parameters" class="section level2">
<h2><span class="header-section-number">28.5</span> Extracting Graph-Theoretic Parameters</h2>
<p>The underlying structure of a <strong>popgraph</strong> object is based upon the <strong>igraph</strong> package from Gabor Csardi. A population graph is essentially a specific kind of <strong>igraph</strong>object and can be decorated with metadata that is useful for spatial population genetic analyses. As such, there is a wealth of existing analyses from both the <strong>igraph</strong> as well as the <strong>sna</strong> packages that can be used on <strong>popgraph</strong> objects. Here are some examples.</p>
<div id="matrix-representations-of-population-graph-objects" class="section level3">
<h3><span class="header-section-number">28.5.1</span> Matrix Representations of Population Graph Objects</h3>
<p>A graph topology is a graphical representation of a matrix and there are several reasons why you may want to use these matrices. The function <code>to_matrix()</code> is an easy front-end to several kinds of matrices. Matrix structure itself can be defined by adjacency matrics, either binary (the default) or weighed by the edge weight. Several graph-theoretic parameters are derived from the adjacency matrix. Here is an example from our little graph that started this document.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_matrix</span>( lopho, <span class="dt">mode=</span><span class="st">&quot;adjacency&quot;</span>)[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>]</code></pre></div>
<pre><code>##     BaC Ctv LaV Lig PtC
## BaC   0   0   1   1   1
## Ctv   0   0   0   0   0
## LaV   1   0   0   1   1
## Lig   1   0   1   0   1
## PtC   1   0   1   1   0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">to_matrix</span>( lopho, <span class="dt">mode=</span><span class="st">&quot;edge weight&quot;</span>)[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>]</code></pre></div>
<pre><code>##           BaC Ctv       LaV      Lig      PtC
## BaC  0.000000   0  9.052676  9.71615 12.38248
## Ctv  0.000000   0  0.000000  0.00000  0.00000
## LaV  9.052676   0  0.000000 12.07282 12.80017
## Lig  9.716150   0 12.072820  0.00000 14.22483
## PtC 12.382480   0 12.800170 14.22483  0.00000</code></pre>
<p>In addition to who each node is connected to, it is often of interest to know the length of the shortest path through the matrix connecting nodes. Here is a slightly larger example, using the cactus data so we can look at isolation by graph distance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cGD &lt;-<span class="st"> </span><span class="kw">to_matrix</span>( lopho, <span class="dt">mode=</span><span class="st">&quot;shortest path&quot;</span>)
cGD[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>]</code></pre></div>
<pre><code>##           BaC       Ctv       LaV      Lig      PtC
## BaC  0.000000  9.195038  9.052676  9.71615 12.38248
## Ctv  9.195038  0.000000 13.083311 15.23302 20.49099
## LaV  9.052676 13.083311  0.000000 12.07282 12.80017
## Lig  9.716150 15.233023 12.072820  0.00000 14.22483
## PtC 12.382480 20.490990 12.800170 14.22483  0.00000</code></pre>
<p>It should be noted that the shortest distance through a population graph is defined as the parameter <span class="math inline">\(cGD\)</span>, conditional graph distance (see Dyer <em>et al.</em> 2010 for more information on this parameter).</p>
<p>Now, we need the physical distance between the nodes. If the physical size of the sampling area is small we could just use the Pythagorean equation. However, here the distance is relatively large and the curvature of the earth may be of interest to take into account. There are seveal functions that will calculate ‘great circle distance’ but the easiest is <code>rdist.earth()</code> from the <strong>fields</strong> funtion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">Stratum =</span> <span class="kw">V</span>(lopho)$name, 
                  <span class="dt">Longitude  =</span><span class="kw">V</span>(lopho)$Longitude, 
                  <span class="dt">Latitude =</span> <span class="kw">V</span>(lopho)$Latitude ) 
pDist &lt;-<span class="st"> </span><span class="kw">strata_distance</span>( df )</code></pre></div>
<p>Now, we can plot these values against each other to see if there is a pattern of ‘isolation by distance’ captured in the graph topology. To do this, I extract only the upper triangle (e.g., the values above the diagonal of each matrix) because they are symmetric matrices and we do not want to look at each datum twice.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">cGD=</span>cGD[<span class="kw">upper.tri</span>(cGD)], <span class="dt">Phys=</span>pDist[<span class="kw">upper.tri</span>(pDist)])
<span class="kw">cor.test</span>( df$Phys, df$cGD, <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)</code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  df$Phys and df$cGD
## S = 729990, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.5270434</code></pre>
<p>We can plot these values and make a trendline pretty easily. Here is a plot using <strong>ggplot2</strong> (a very nice plotting library; you could use <code>plot()</code> to do the normal plotting but I think <strong>ggplot2</strong> does such a nice job I encourage its use).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>( Phys, cGD, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">data=</span>df) +<span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Physical Distance&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Conditional Genetic Distance&quot;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-492-1.png" width="672" /></p>
<p>The trendline is the loess predicted line with confidence interval.</p>
</div>
<div id="node-specific-parameters" class="section level3">
<h3><span class="header-section-number">28.5.2</span> Node Specific Parameters</h3>
<p>Features of the topology can be extracted as either properties of the nodes or the edges. Node properties may provide insights into localized processes (e.g., a ‘sink’ population). There are a lot of different parameters that can be derived and several packages in R that help out. Here are some basic ones.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.nodes$closeness &lt;-<span class="st"> </span><span class="kw">closeness</span>(lopho)
df.nodes$betweenness &lt;-<span class="st"> </span><span class="kw">betweenness</span>(lopho)
df.nodes$degree &lt;-<span class="st"> </span><span class="kw">degree</span>( lopho )
df.nodes$eigenCent &lt;-<span class="st"> </span><span class="kw">evcent</span>( lopho )$vector
df.nodes$Region &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">V</span>(lopho)$Region)
<span class="kw">summary</span>(df.nodes,<span class="dt">color=</span><span class="st">&quot;Region&quot;</span>)</code></pre></div>
<pre><code>##       Pop        Latitude       Longitude        Elevation    
##  BaC    : 1   Min.   :23.58   Min.   :-114.7   Min.   :  5.0  
##  CP     : 1   1st Qu.:25.73   1st Qu.:-112.9   1st Qu.: 14.0  
##  Ctv    : 1   Median :28.82   Median :-112.0   Median : 66.0  
##  LaV    : 1   Mean   :27.91   Mean   :-112.2   Mean   :159.2  
##  LF     : 1   3rd Qu.:29.73   3rd Qu.:-111.3   3rd Qu.:259.0  
##  Lig    : 1   Max.   :31.95   Max.   :-110.0   Max.   :667.0  
##  (Other):15                                                   
##    closeness         betweenness        degree        eigenCent        
##  Min.   :0.002202   Min.   : 0.00   Min.   :3.000   Min.   :0.0005975  
##  1st Qu.:0.002466   1st Qu.: 0.00   1st Qu.:4.000   1st Qu.:0.0040621  
##  Median :0.002919   Median : 4.00   Median :5.000   Median :0.1514600  
##  Mean   :0.002891   Mean   :17.43   Mean   :4.952   Mean   :0.3043499  
##  3rd Qu.:0.003227   3rd Qu.:25.00   3rd Qu.:6.000   3rd Qu.:0.6687298  
##  Max.   :0.003844   Max.   :98.00   Max.   :7.000   Max.   :1.0000000  
##                                                                        
##  Region
##  1:12  
##  2: 9  
##        
##        
##        
##        
## </code></pre>
<p>The relationship betwwen the node variables can be evaluated in a pair plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(df.nodes,<span class="dt">columns=</span><span class="dv">2</span>:<span class="dv">9</span>, <span class="dt">color=</span><span class="st">&#39;Region&#39;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-494-1.png" width="768" /></p>
</div>
<div id="edge-specific-parameters" class="section level3">
<h3><span class="header-section-number">28.5.3</span> Edge Specific Parameters</h3>
<p>Edges may have specific properties as well. Here are some examples using betweeness centrality, community, and regionality (if the edge connects within Baja or Sonora or crosses the Sea of Cortéz).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.edge &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">Weight=</span><span class="kw">E</span>(lopho)$weight )
df.edge$betweenness &lt;-<span class="st"> </span><span class="kw">edge.betweenness</span>(lopho)
df.edge$Region &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;Baja&quot;</span>,<span class="dv">52</span>)
df.edge$Region[<span class="dv">36</span>:<span class="dv">52</span>] &lt;-<span class="st"> &quot;Sonora&quot;</span>
df.edge$Region[<span class="kw">c</span>(<span class="dv">11</span>,<span class="dv">24</span>,<span class="dv">27</span>,<span class="dv">35</span>)] &lt;-<span class="st"> &quot;Cortez&quot;</span>
<span class="kw">ggpairs</span>(df.edge, <span class="dt">color=</span><span class="st">&quot;Region&quot;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-495-1.png" width="672" /></p>
</div>
</div>
<div id="testing-for-topological-congruence" class="section level2">
<h2><span class="header-section-number">28.6</span> Testing for Topological Congruence</h2>
<p>If you have more than one topology and the node sets overlap sufficiently, you can test for the topological congruence of the two. There are several specific reasons why population graph topologies may be congruent. In this section we use the spatial genetic structure of the Senita cactus (<em>Lophocereus schottii</em>) and its obligate pollinator, <em>Upiga virescens</em> as an example. This is an obligate pollination mutualism and as such we should expect there to be some degree of spatial genetic congruence between the species due to this co-evolution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(upiga)
upiga &lt;-<span class="st"> </span><span class="kw">decorate_graph</span>(upiga,baja,<span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>)
upiga.nodes &lt;-<span class="st"> </span><span class="kw">to_SpatialPoints</span>(upiga)
upiga.edges &lt;-<span class="st"> </span><span class="kw">to_SpatialLines</span>(upiga)</code></pre></div>
<p>These two data sets were ‘mostly’ collected in the same physical locations. Here is a comparison of the two topologies.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(lopho)
<span class="kw">plot</span>(upiga)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-497-1.png" width="864" /></p>
<p>You can clearly see some differences in both the node and edge sets. However, given the relationship between these organisms, there is an expectation that they should share some spatial structure. The function <code>congruence_topology()</code> is designed to extract the congruence graph that is the intersection of both node and edge sets. If the node sets are not completely overlapping (in this case they are not), it will give you a warning. If you want to compare topologies, you must start with identical node sets because the topology in a Population Graph is based upon the entire structure, not just pairwise differences. See the writeup about the <strong>gstudio</strong> package for more information on this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cong &lt;-<span class="st"> </span><span class="kw">congruence_topology</span>(lopho,upiga)
<span class="kw">plot</span>(cong)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-498-1.png" width="672" /></p>
<p>We can then take the congruence graph and plot it or work with it in the normal fashion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cong &lt;-<span class="st"> </span><span class="kw">decorate_graph</span>( cong, baja )
cong.nodes &lt;-<span class="st"> </span><span class="kw">to_SpatialPoints</span>(cong)
cong.edges &lt;-<span class="st"> </span><span class="kw">to_SpatialLines</span>(cong)
<span class="kw">plot</span>(alt)
<span class="kw">plot</span>(cong.edges,<span class="dt">add=</span>T)
<span class="kw">plot</span>(cong.nodes,<span class="dt">add=</span>T, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="amg_files/figure-html/unnamed-chunk-499-1.png" width="672" /></p>
<p>There are several ways to examine ‘congruence’ in graph topologies, of which I show two. The first method is based upon the correlation of pair-wise distance through the graph for each. That is to say, are proximate nodes in <code>lopho</code> similarily close in <code>upiga</code>? This is called “Distance Congruence” and is based upon a non-parametric correlation of path distances.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test_congruence</span>(lopho,upiga,<span class="dt">method=</span><span class="st">&quot;distance&quot;</span>)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  distances.graph1 and distances.graph2
## t = 7.3025, df = 118, p-value = 3.6e-11
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4207347 0.6701315
## sample estimates:
##       cor 
## 0.5579029</code></pre>
<p>Another way is to ask about the pattern of connectivity. Based upon the number of nodes and edges in <code>lopho</code> and <code>upiga</code>, are there more in the congruence graph than could be expected if the two graph were just randomly associated? This is called “Structural Congruence” and is determined combinatorially. What is returned by this is the probability having as many edges as observed in the congruence graph given the size of the edge sets in the predictor graphs. You can think of this as the fraction of the area under the line as large or larger than the observed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test_congruence</span>(lopho,upiga, <span class="dt">method=</span><span class="st">&quot;combinatorial&quot;</span>)</code></pre></div>
<pre><code>##        CDF 
## 0.03625037</code></pre>
<p>Hope this provides enough of an overview of the <strong>popgraph</strong> package to get you started. If you have any questions feel free to email [<a href="mailto://rjdyer@vcu.edu">mailto://rjdyer@vcu.edu</a>].</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>This is a truly hypothetical and contrived example to show how you would do this in the code and is not motivated by any biologically motivated reasons. Ya’ gotta make up examples sometimes…<a href="population-graphs.html#fnref5">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distance-networks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-visualization.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"instapaper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
